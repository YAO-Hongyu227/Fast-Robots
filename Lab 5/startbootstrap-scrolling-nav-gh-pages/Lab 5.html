<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Scrolling Nav - Start Bootstrap Template</title>
        <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
    </head>
    <style>
        code {
            counter-reset: line;
            display: block;
            background-color: #6abebe28;
            white-space: pre;
            overflow-x: scroll;
            overflow-y: scroll;
            max-width: 100%;
            min-width: 100px;
            padding: 0;
            box-shadow: 5px 5px 10px #888888;
            transition: box-shadow 0.3s ease-in-out;
        }
    </style>


    <body id="page-top"  >
        <!-- Navigation-->
        <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top" id="mainNav">
            <div class="container px-4">
                <a class="navbar-brand" href="#page-top">Lab5 Motor Driver</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
                <div class="collapse navbar-collapse" id="navbarResponsive">
                    <ul class="navbar-nav ms-auto">
                        <li class="nav-item"><a class="nav-link" href="#about">Objective</a></li>
                        <li class="nav-item"><a class="nav-link" href="#services">Lab</a></li>
                        <li class="nav-item"><a class="nav-link" href="#contact">Additional</a></li>
                    </ul>
                </div>
            </div>
        </nav>
        <!-- Header-->
        <header class="bg-primary bg-gradient text-white">
            <div class="container px-4 text-center">
                <h1 class="fw-bolder">Welcome to Motor Driver Section</h1>
                <p class="lead"> Using Motor Driver to control the rolling direction and speed of the DC Motor!</p>
                <a class="btn btn-lg btn-light" href="#about">Start scrolling!</a>
            </div>
        </header>
        <!-- About section-->
        <section id="about">
            <div class="container px-4">
                <div class="row gx-4 justify-content-center">
                    <div class="col-lg-8">
                        <h2>Objective</h2>
                        <p class="lead">The purpose of this lab is for you to change from manual to open loop control of the car. At the end of this lab, your car should be able to execute a pre-programmed series of moves, using the Artemis board and two dual motor drivers.</p>
                        <ul>
                            <li>Solder the motor driver to Arduino </li>
                            <li>Install everything on the car </li>
                            <li>Use oscilloscope to get the PWM out of motor driver</li>
                            <li>Make the car forward, backward, turn direction in different speed</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>


        <!-- TASK 1-->
        <section class="bg-light" id="services">
            <div class="container px-4">
                <div class="row gx-4 justify-content-center">
                    <div class="col-lg-8 ">
                        <h2>Task 1</h2>
                        <p class="lead">Correctly connect motor drivers to the Arduino Board</p>

                        <p style="font-weight: normal">The power supply of the motor driver comes from the battery, which is 3.7V, so the VIN pin should connect to the positive pin of the battery. Note that we could also use VMM as the positive power supply pin, but usually we use VIN pin to achieve this function.</p>
                        <p style="font-weight: normal">All of the motor drivers' GND pins should be connected to the GND of the Arduino, this is to ensure the absolute voltage of Arduino board's gpio pin is consistent with our setting in the program.</p>
                        <p style="font-weight: normal">Normally one motor driver could control two motors by using A1/2 IN and A1/2 OUT pins or B1/2 IN and B1/2 OUT pins. In which the number '1' and '2' controls the direction of the motor. For example, when A1 is high and A2 is low, the motor rolls in clock direction, then when A1 is low and A2 is high, the motor will roll in counter-clockwise direction. </p>
                        <p style="font-weight: normal">And the PWM of the Input pin of the motor driver controls the speed/torque of the motor. To make our motor have a higher voltage to supply enough torque to make the car move, we connnect the A and B pins together, shown in the figure below.</p>

                        <center><img src=".\picture\circuit.png" style="box-shadow: 5px 5px 10px #888888;" alt="Description of the image" width="600" height="450"></center>
                        <p></p>

                    </div>
                </div>
            </div>
        </section>

        <!-- TASK 2-->
        <section class="bg-light" id="services">
            <div class="container px-4">
                <div class="row gx-4 justify-content-center">
                    <div class="col-lg-8 justify-content-center">
                        <h2>Task 2</h2>
                        <p class="lead">Assemble the car</p>
                        
             
                        <p style="font-weight: normal">Here is the planform of my car, I used some 3D printed compoents to(The white one in the figure) tightly assemble our board/sensors to the car, and more components will be introduced below.</p>
                        <p></p>
                        <!-- neg 90 roll-->
                        <center><img src=".\picture\top.jpg" style="box-shadow: 5px 5px 10px #888888;" alt="Description of the image" width="600" height="600"></center>
                        <p></p>
                        <p style="font-weight: normal">At the front of the  car, there are IMU and one TOF components to detect the roll,pitch,roll and the obstacles in front of the car.</p>
                        <p></p>
                        <!-- neg 90 roll-->
                        <center><img src=".\picture\front.jpg" style="box-shadow: 5px 5px 10px #888888;" alt="Description of the image" width="600" height="600"></center>
                        <p></p>
                        <p style="font-weight: normal">There is another ToF sensor at the side of the car, shown in the figure below. </p>
                        <p></p>
                        <!-- neg 90 roll-->
                        <center><img src=".\picture\side.jpg" style="box-shadow: 5px 5px 10px #888888;" alt="Description of the image" width="600" height="600"></center>
                        <p></p>
                        <p style="font-weight: normal">At the back of the car, i removed the cover of the battery holder and put the Arduino board and motor driver inside, this is to make sure we got more space so that all components could attached tightly to the car in case the car flips. In the same time, as shown below, the power supply port and USB-C port is easy to be connected.</p>
                        <p></p>
                        <!-- neg 90 roll-->
                        <center><img src=".\picture\back.jpg" style="box-shadow: 5px 5px 10px #888888;" alt="Description of the image" width="600" height="600"></center>
                        <p></p>
                        <p style="font-weight: normal">Here below is a simple demonstration showing that the motor driver is under the Arduino board.</p>
                        <p></p>
                        <!-- neg 90 roll-->
                        <center><img src=".\picture\driver.jpg" style="box-shadow: 5px 5px 10px #888888;" alt="Description of the image" width="600" height="600"></center>
                        <p></p>
                    </div>
                </div>
            </div>
        </section>

        <!-- TASK 3-->
        <section class="bg-light" id="services">
            <div class="container px-4">
                <div class="row gx-4 justify-content-center">
                    <div class="col-lg-8 justify-content-center">
                        <h2>Task 3</h2>
                        <p class="lead">Control the motion of the car</p>
                        
                        <p style="font-weight: normal">I used the following code to control the motion of the car, by changing the value of curr_speed, we could control the speed of the car, and by inversing the value of motorA_in1 and motorA_in2, we could change the rolling direction of the left motor, and same for the right motor.</p>
                        <center><img src=".\picture\code.png" style="box-shadow: 5px 5px 10px #888888;" alt="Description of the image" width="600" height="800"></center>
                        <p></p>
                        <center><iframe width="560" height="315" src=https://youtube.com/embed/JOE3nhDSFeM?feature=share frameborder="0" allowfullscreen></iframe></center>
                        <p></p>
                        <p style="font-weight: normal">And then I used the oscilloscope to monitor the output voltage of the motor driver when the wheel is rolling, the result is shown below:</p>
                        <center><img src=".\picture\osc.jpg" style="box-shadow: 5px 5px 10px #888888;" alt="Description of the image" width="600" height="800"></center>
                        <p></p>
                        <p></p>
                                </div>
                                </div>
                                </div>
                                </section>



        <!-- TASK 4-->
        <section class="bg-light" id="services">
            <div class="container px-4">
                <div class="row gx-4 justify-content-center">
                    <div class="col-lg-8 justify-content-center">
                        <h2>Task 4</h2>
                        <p class="lead">Open loop control</p>
                        
                        <p></p>
                        <p style="font-weight: normal">In this experiement, I found out that the required PWM for turning direction is more than that of going forward/backward. At first, I set both PWM to 70 and the car only go back and forth, cannot turning direction. Then I adjust the truning PWM to 2*forwardPWM = 140, in this case the car can turn direction quickly. </p>
                        
                        <p></p>
                        <p style="font-weight: normal">The video of open loop is shown below, the operation loop is forward -> stop -> turn right -> turn left -> forward.</p>
                        <center><iframe width="560" height="315" src="https://youtube.com/embed/YkhWiy5Dr0M?feature=share" frameborder="0" allowfullscreen></iframe></center>
                        
                        
                        <p style="font-weight: normal">And the code of the main loop is attached here:</p>
                        <center><img src=".\picture\loop.png" style="box-shadow: 5px 5px 10px #888888;" alt="Description of the image" width="600" height="600"></center>

                   
                    </div>
                </div>
            </div>
        </section>

        <!-- Additional Task1-->
        <section class="bg-light" id="services">
            <div class="container px-4">
                <div class="row gx-4 justify-content-center">
                    <div class="col-lg-8 justify-content-center">
                        <h2>Additional Task 1</h2>
                        <p class="lead">Consider what frequency analogWrite generates. Is this adequately fast for these motors? Can you think of any benefits to manually configuring the timers to generate a faster PWM signal?</p>

                        <p></p>
                        <p style="font-weight: normal">As shown in the figure below, when the PWM is 100 for analogWrite, the frequency(right-top) is about 227Hz. Because I cannot find the mannual for the motor that we use, so I have no idea whether this frequency is in its operation frequency range, but the car can run smoothly under this frequency, so I think this frequency is quite adequately fast for the motors. </p>
                        <center><img src=".\picture\fre.png" style="box-shadow: 5px 5px 10px #888888;" alt="Description of the image" width="600" height="400"></center>
                        <p></p>
                        <p style="font-weight: normal">If we could manually generate a faster PWM signal, it will help to reduce the influence caused by low frequency noise, and also the motor may gain more power to make the car run faster. </p>



                    </div>
                </div>
            </div>
        </section>

        <!-- Additional Task2-->
        <section class="bg-light" id="services">
            <div class="container px-4">
                <div class="row gx-4 justify-content-center">
                    <div class="col-lg-8 justify-content-center">
                        <h2>Additional Task 2</h2>
                        <p class="lead">Relating to task 8 above, try to (experimentally) figure out not just at what PWM value the robot starts moving (forward and on-axis turns), but also the lowest PWM value at which you can keep the robot running once it is in motion. How quickly can you have the robot settle at its slowest speed? (First program a value that overcomes static friction and gets the robot moving, then a value that keeps it moving as slowly as possible.)</p>
                        
                        <p style="font-weight: normal">The result after testing the minimum PWM in different situations is shown in the table below</p>

                        <center><img src=".\picture\table.png" style="box-shadow: 5px 5px 10px #888888;" alt="Description of the image" width="600" height="250
                            "></center>

  
                      
                    </div>
                </div>
            </div>
        </section>

        
        <!-- Footer-->
        <footer class="py-5 bg-dark">
            <div class="container px-4"><p class="m-0 text-center text-white">Copyright &copy; Hongyu Yao 2024</p></div>
        </footer>
        <!-- Bootstrap core JS-->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
        <!-- Core theme JS-->
        <script src="js/scripts.js"></script>
    </body>
</html>
